
repeatable read, serializableどちらも、
current_timestampを参照するたびに取得された時間がずれた

一律同じタイムスタンプにしたい場合どうするか...

MySQLの場合、そのSQL文が実行されたタイムスタンプが取得されるので、
SQL文ごとにcurrent_timestamp(now())の値は異なる
SQL文の内部では一定の値になるようだ


SET SESSION timestamp = UNIX_TIMESTAMP()
で値を固定できたが、トランザクションなど他への影響があるのかないのかよくわからない


そもそも全更新レコードのタイムスタンプを同じにしないといけないのだろうか？
そもそもタイムスタンプ値が異なっていて何が問題、欠点になるだろうか
タイムスタンプがそろっていれば、同じトランザクションの処理だとすぐわかる

クエリが実行された時間であれば、正確にどの時点で実行されたのかがわかる
最初に取得した値で統一すると、正確な実行された時間がわからなくなる

実行されるクエリを全部ログに記録しておけば、あとからこれを調べればわかるか


タイムスタンプではなくてトランザクションIDを専用カラムにセットする
トランザクションIDというのは簡単には取得できなさそう

SET @start = now()
クライアントプログラムで最初に上記を発行（ユーザー定義変数のセット）
ユーザー定義変数を使うほうがSET timestampよりもよさそう

